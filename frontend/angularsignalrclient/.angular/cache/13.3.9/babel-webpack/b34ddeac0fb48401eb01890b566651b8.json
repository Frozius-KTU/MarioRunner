{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\damir\\\\Desktop\\\\7 Semestras\\\\MarioRunner\\\\frontend\\\\angularsignalrclient\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\Users\\\\damir\\\\Desktop\\\\7 Semestras\\\\MarioRunner\\\\frontend\\\\angularsignalrclient\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { environment } from '@environments/environment';\nimport { HubConnectionBuilder, HubConnectionState, LogLevel } from '@microsoft/signalr';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport var SignalRService = /*#__PURE__*/(function () {\n  var SignalRService = /*#__PURE__*/function () {\n    function SignalRService() {\n      _classCallCheck(this, SignalRService);\n\n      this.foodchanged$ = new Subject();\n      this.messageReceived$ = new Subject();\n      this.newCpuValue$ = new Subject();\n      this.connectionEstablished$ = new BehaviorSubject(false);\n      this.createConnection();\n      this.registerOnServerEvents();\n      this.startConnection();\n    }\n\n    _createClass(SignalRService, [{\n      key: \"sendChatMessage\",\n      value: function sendChatMessage(message) {\n        this.hubConnection.invoke('SendMessage', message);\n      }\n    }, {\n      key: \"createConnection\",\n      value: function createConnection() {\n        this.hubConnection = new HubConnectionBuilder().withUrl(environment.baseUrls.server + 'coolmessages').withAutomaticReconnect().configureLogging(LogLevel.Information).build();\n      }\n    }, {\n      key: \"startConnection\",\n      value: function startConnection() {\n        var _this = this;\n\n        if (this.hubConnection.state === HubConnectionState.Connected) {\n          return;\n        }\n\n        this.hubConnection.start().then(function () {\n          console.log('Hub connection started!');\n\n          _this.connectionEstablished$.next(true);\n        }, function (error) {\n          return console.error(error);\n        });\n      }\n    }, {\n      key: \"registerOnServerEvents\",\n      value: function registerOnServerEvents() {\n        var _this2 = this;\n\n        this.hubConnection.on('FoodAdded', function (data) {\n          _this2.foodchanged$.next(data);\n        });\n        this.hubConnection.on('FoodDeleted', function (data) {\n          _this2.foodchanged$.next('this could be data');\n        });\n        this.hubConnection.on('FoodUpdated', function (data) {\n          _this2.foodchanged$.next('this could be data');\n        });\n        this.hubConnection.on('Send', function (data) {\n          console.log('data', data);\n\n          _this2.messageReceived$.next(data);\n        });\n        this.hubConnection.on('newCpuValue', function (data) {\n          _this2.newCpuValue$.next(data);\n        });\n      }\n    }]);\n\n    return SignalRService;\n  }();\n\n  SignalRService.ɵfac = function SignalRService_Factory(t) {\n    return new (t || SignalRService)();\n  };\n\n  SignalRService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: SignalRService,\n    factory: SignalRService.ɵfac,\n    providedIn: 'root'\n  });\n  return SignalRService;\n})();","map":null,"metadata":{},"sourceType":"module"}